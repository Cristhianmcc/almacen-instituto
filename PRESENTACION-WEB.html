<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Control de Almacén - Documentación</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
            background: #f8f9fa;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            font-size: 2.5em;
        }
        h2 {
            color: #34495e;
            margin-top: 40px;
            font-size: 1.8em;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #2c3e50;
            margin-top: 30px;
            font-size: 1.4em;
        }
        .emoji {
            font-size: 1.2em;
            margin-right: 5px;
        }
        .architecture-diagram {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: monospace;
            text-align: center;
            margin: 20px 0;
            border: 2px solid #bdc3c7;
        }
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
        }
        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .table th, .table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .table th {
            background: #3498db;
            color: white;
        }
        .table tr:nth-child(even) {
            background: #f2f2f2;
        }
        .status-complete {
            color: #27ae60;
            font-weight: bold;
        }
        .status-progress {
            color: #f39c12;
            font-weight: bold;
        }
        .highlight-box {
            background: #e8f6f3;
            border: 1px solid #1abc9c;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .conclusion {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin: 40px 0;
        }
        .toc {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        .toc li {
            margin: 8px 0;
        }
        .toc a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        @media print {
            body { background: white; }
            .container { box-shadow: none; }
            .no-print { display: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="emoji">📋</span>SISTEMA DE CONTROL DE ALMACÉN</h1>
        <h2 style="text-align: center; color: #7f8c8d;">Instituto Educativo Lurín</h2>
        
        <div class="toc">
            <h3><span class="emoji">📖</span>Índice de Contenidos</h3>
            <ul>
                <li><a href="#informacion-general">🎯 Información General</a></li>
                <li><a href="#arquitectura">🏗️ Arquitectura del Sistema</a></li>
                <li><a href="#tecnologias">💻 Tecnologías Utilizadas</a></li>
                <li><a href="#estructura">📁 Estructura del Proyecto</a></li>
                <li><a href="#base-datos">🗄️ Base de Datos</a></li>
                <li><a href="#endpoints">🌐 API REST Endpoints</a></li>
                <li><a href="#funcionalidades">⚙️ Funcionalidades Principales</a></li>
                <li><a href="#configuracion">🚀 Configuración y Despliegue</a></li>
                <li><a href="#testing">🧪 Testing y Validación</a></li>
                <li><a href="#integracion">🔗 Integración con Frontend</a></li>
            </ul>
        </div>

        <div id="informacion-general">
            <h2><span class="emoji">🎯</span>Información General</h2>
            
            <h3>Propósito del Sistema</h3>
            <p>Sistema de escritorio para control de inventario y almacén del Instituto Lurín que permite:</p>
            <ul>
                <li>Gestión completa de productos e inventario</li>
                <li>Control de movimientos (entradas y salidas)</li>
                <li>Sistema de alertas automáticas</li>
                <li>Generación de reportes detallados</li>
                <li>Gestión de sobrantes y bajas</li>
                <li>Integración con sistemas existentes (SIGA)</li>
            </ul>

            <div class="highlight-box">
                <h3><span class="emoji">🎯</span>Objetivos del Proyecto</h3>
                <ul>
                    <li><strong>Automatizar</strong> el control de inventario manual existente</li>
                    <li><strong>Eliminar</strong> errores humanos en el registro de movimientos</li>
                    <li><strong>Generar</strong> alertas automáticas de stock bajo y productos próximos a vencer</li>
                    <li><strong>Proporcionar</strong> reportes en tiempo real para toma de decisiones</li>
                    <li><strong>Integrar</strong> con el sistema académico NetBeans existente</li>
                </ul>
            </div>
        </div>

        <div id="arquitectura">
            <h2><span class="emoji">🏗️</span>Arquitectura del Sistema</h2>
            
            <h3>Patrón Arquitectónico: MVC (Model-View-Controller)</h3>
            <div class="architecture-diagram">
                ┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐<br>
                │   FRONTEND      │    │    BACKEND       │    │   BASE DATOS    │<br>
                │   (NetBeans)    │◄──►│   (Node.js)      │◄──►│   (Supabase)    │<br>
                │   Puerto 8080   │    │   Puerto 3003    │    │   PostgreSQL    │<br>
                └─────────────────┘    └──────────────────┘    └─────────────────┘
            </div>
        </div>

        <div id="endpoints">
            <h2><span class="emoji">🌐</span>API REST Endpoints</h2>
            
            <h3>Resumen de Endpoints (27 total)</h3>
            <table class="table">
                <thead>
                    <tr>
                        <th>Módulo</th>
                        <th>GET</th>
                        <th>POST</th>
                        <th>PUT</th>
                        <th>DELETE</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Health</td>
                        <td>1</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td><strong>1</strong></td>
                    </tr>
                    <tr>
                        <td>Productos</td>
                        <td>4</td>
                        <td>1</td>
                        <td>1</td>
                        <td>1</td>
                        <td><strong>7</strong></td>
                    </tr>
                    <tr>
                        <td>Movimientos</td>
                        <td>3</td>
                        <td>2</td>
                        <td>0</td>
                        <td>0</td>
                        <td><strong>5</strong></td>
                    </tr>
                    <tr>
                        <td>Alertas</td>
                        <td>2</td>
                        <td>1</td>
                        <td>2</td>
                        <td>0</td>
                        <td><strong>5</strong></td>
                    </tr>
                    <tr>
                        <td>Sobrantes</td>
                        <td>3</td>
                        <td>1</td>
                        <td>1</td>
                        <td>0</td>
                        <td><strong>5</strong></td>
                    </tr>
                    <tr>
                        <td>Bajas (Withdrawals)</td>
                        <td>3</td>
                        <td>1</td>
                        <td>0</td>
                        <td>0</td>
                        <td><strong>4</strong></td>
                    </tr>
                    <tr>
                        <td>Reportes</td>
                        <td>4</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td><strong>4</strong></td>
                    </tr>
                    <tr style="background: #3498db; color: white; font-weight: bold;">
                        <td>TOTAL</td>
                        <td>20</td>
                        <td>6</td>
                        <td>4</td>
                        <td>1</td>
                        <td>31</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="tecnologias">
            <h2><span class="emoji">💻</span>Tecnologías Utilizadas</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0;">
                <div class="highlight-box">
                    <h3><span class="emoji">⚙️</span>Backend</h3>
                    <ul>
                        <li><strong>Runtime:</strong> Node.js v18+</li>
                        <li><strong>Framework:</strong> Express.js v4.18+</li>
                        <li><strong>Base de Datos:</strong> PostgreSQL 15 (Supabase)</li>
                        <li><strong>Validación:</strong> Joi v17+</li>
                        <li><strong>CORS:</strong> cors v2.8+</li>
                    </ul>
                </div>
                
                <div class="highlight-box">
                    <h3><span class="emoji">🛠️</span>Desarrollo</h3>
                    <ul>
                        <li><strong>Editor:</strong> Visual Studio Code</li>
                        <li><strong>Testing:</strong> Jest + Supertest</li>
                        <li><strong>API Testing:</strong> Postman / Thunder Client</li>
                        <li><strong>Control Versiones:</strong> Git</li>
                        <li><strong>Package Manager:</strong> npm</li>
                    </ul>
                </div>
                
                <div class="highlight-box">
                    <h3><span class="emoji">🖥️</span>Frontend (Integración)</h3>
                    <ul>
                        <li><strong>Lenguaje:</strong> Java</li>
                        <li><strong>IDE:</strong> NetBeans</li>
                        <li><strong>HTTP Client:</strong> Java 11+ HttpClient</li>
                        <li><strong>Puerto:</strong> 8080 (típico NetBeans)</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="estructura">
            <h2><span class="emoji">📁</span>Estructura del Proyecto</h2>
            
            <div class="code-block">
almacen-instituto/<br>
├── 📁 src/<br>
│   ├── 📄 app.js                    # Aplicación principal<br>
│   ├── 📁 config/<br>
│   │   └── 📄 database.js           # Configuración de Supabase<br>
│   ├── 📁 controllers/<br>
│   │   ├── 📄 productController.js  # Lógica de productos<br>
│   │   ├── 📄 movementController.js # Lógica de movimientos<br>
│   │   ├── 📄 reportController.js   # Lógica de reportes<br>
│   │   ├── 📄 surplusController.js  # Lógica de sobrantes<br>
│   │   └── 📄 withdrawalController.js # Lógica de bajas<br>
│   ├── 📁 middleware/<br>
│   │   └── 📄 validation.js         # Esquemas de validación Joi<br>
│   ├── 📁 routes/<br>
│   │   ├── 📄 products.js           # Rutas de productos<br>
│   │   ├── 📄 movements.js          # Rutas de movimientos<br>
│   │   ├── 📄 reports.js            # Rutas de reportes<br>
│   │   ├── 📄 alerts.js             # Rutas de alertas<br>
│   │   ├── 📄 surplus.js            # Rutas de sobrantes<br>
│   │   └── 📄 withdrawals.js        # Rutas de bajas<br>
│   ├── 📁 services/<br>
│   │   ├── 📄 supabaseClient.js     # Cliente de Supabase<br>
│   │   └── 📄 alertService.js       # Servicio de alertas<br>
│   └── 📁 utils/<br>
│       ├── 📄 dateUtils.js          # Utilidades de fecha<br>
│       └── 📄 responseUtils.js      # Utilidades de respuesta<br>
├── 📁 tests/<br>
│   ├── 📄 api.test.js               # Tests de API<br>
│   ├── 📄 utils.test.js             # Tests de utilidades<br>
│   └── 📄 setup.js                  # Configuración de tests<br>
├── 📄 package.json                  # Dependencias y scripts<br>
└── 📄 README.md                     # Documentación básica
            </div>
        </div>

        <div id="base-datos">
            <h2><span class="emoji">🗄️</span>Base de Datos</h2>
            
            <h3>Proveedor: Supabase (PostgreSQL)</h3>
            <div class="highlight-box">
                <p><strong>URL:</strong> https://supabase.com/</p>
                <p><strong>Tipo:</strong> Database as a Service (DBaaS)</p>
                <p><strong>Ventajas:</strong> Hosting gratuito, APIs automáticas, tiempo real, autenticación</p>
            </div>

            <h3>Esquema Completo de Base de Datos</h3>
            
            <h4><span class="emoji">📦</span>Tabla: productos</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>Campo</th>
                        <th>Tipo</th>
                        <th>Descripción</th>
                        <th>Restricciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>id</strong></td>
                        <td>SERIAL</td>
                        <td>Identificador único</td>
                        <td>PRIMARY KEY, AUTO_INCREMENT</td>
                    </tr>
                    <tr>
                        <td><strong>codigo_item</strong></td>
                        <td>VARCHAR(50)</td>
                        <td>Código único del producto</td>
                        <td>UNIQUE, NOT NULL</td>
                    </tr>
                    <tr>
                        <td><strong>nombre_item</strong></td>
                        <td>VARCHAR(255)</td>
                        <td>Nombre del producto</td>
                        <td>NOT NULL</td>
                    </tr>
                    <tr>
                        <td><strong>nombre_marca</strong></td>
                        <td>VARCHAR(255)</td>
                        <td>Marca del producto</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>orden_compra</strong></td>
                        <td>VARCHAR(50)</td>
                        <td>Número de orden de compra</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>nombre_medida</strong></td>
                        <td>VARCHAR(50)</td>
                        <td>Unidad de medida</td>
                        <td>NOT NULL</td>
                    </tr>
                    <tr>
                        <td><strong>mayor</strong></td>
                        <td>DECIMAL(10,2)</td>
                        <td>Precio mayor</td>
                        <td>DEFAULT 0</td>
                    </tr>
                    <tr>
                        <td><strong>sub_cta</strong></td>
                        <td>VARCHAR(50)</td>
                        <td>Sub cuenta contable</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>stock_actual</strong></td>
                        <td>INTEGER</td>
                        <td>Cantidad actual en almacén</td>
                        <td>DEFAULT 0, CHECK (stock_actual >= 0)</td>
                    </tr>
                    <tr>
                        <td><strong>fecha_ingreso</strong></td>
                        <td>DATE</td>
                        <td>Fecha de ingreso al almacén</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>fecha_vencimiento</strong></td>
                        <td>DATE</td>
                        <td>Fecha de vencimiento</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>estado</strong></td>
                        <td>VARCHAR(50)</td>
                        <td>Estado del producto</td>
                        <td>DEFAULT 'activo', CHECK (estado IN ('activo', 'vencido', 'baja', 'sobrante'))</td>
                    </tr>
                    <tr>
                        <td><strong>created_at</strong></td>
                        <td>TIMESTAMP</td>
                        <td>Fecha de creación</td>
                        <td>DEFAULT CURRENT_TIMESTAMP</td>
                    </tr>
                    <tr>
                        <td><strong>updated_at</strong></td>
                        <td>TIMESTAMP</td>
                        <td>Fecha de última actualización</td>
                        <td>DEFAULT CURRENT_TIMESTAMP</td>
                    </tr>
                </tbody>
            </table>

            <h4><span class="emoji">🔄</span>Tabla: movimientos</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>Campo</th>
                        <th>Tipo</th>
                        <th>Descripción</th>
                        <th>Restricciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>id</strong></td>
                        <td>SERIAL</td>
                        <td>Identificador único</td>
                        <td>PRIMARY KEY, AUTO_INCREMENT</td>
                    </tr>
                    <tr>
                        <td><strong>producto_id</strong></td>
                        <td>INTEGER</td>
                        <td>ID del producto relacionado</td>
                        <td>FOREIGN KEY (productos.id) ON DELETE CASCADE</td>
                    </tr>
                    <tr>
                        <td><strong>tipo_movimiento</strong></td>
                        <td>VARCHAR(50)</td>
                        <td>Tipo de movimiento</td>
                        <td>NOT NULL, CHECK (tipo_movimiento IN ('entrada', 'salida'))</td>
                    </tr>
                    <tr>
                        <td><strong>cantidad</strong></td>
                        <td>INTEGER</td>
                        <td>Cantidad del movimiento</td>
                        <td>NOT NULL, CHECK (cantidad > 0)</td>
                    </tr>
                    <tr>
                        <td><strong>fecha_movimiento</strong></td>
                        <td>TIMESTAMP</td>
                        <td>Fecha del movimiento</td>
                        <td>DEFAULT CURRENT_TIMESTAMP</td>
                    </tr>
                    <tr>
                        <td><strong>usuario</strong></td>
                        <td>VARCHAR(255)</td>
                        <td>Usuario responsable</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>observaciones</strong></td>
                        <td>TEXT</td>
                        <td>Notas adicionales</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>stock_anterior</strong></td>
                        <td>INTEGER</td>
                        <td>Stock antes del movimiento</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>stock_post_movimiento</strong></td>
                        <td>INTEGER</td>
                        <td>Stock después del movimiento</td>
                        <td>NULLABLE</td>
                    </tr>
                </tbody>
            </table>

            <h4><span class="emoji">🚨</span>Tabla: alertas</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>Campo</th>
                        <th>Tipo</th>
                        <th>Descripción</th>
                        <th>Restricciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>id</strong></td>
                        <td>SERIAL</td>
                        <td>Identificador único</td>
                        <td>PRIMARY KEY, AUTO_INCREMENT</td>
                    </tr>
                    <tr>
                        <td><strong>producto_id</strong></td>
                        <td>INTEGER</td>
                        <td>ID del producto relacionado</td>
                        <td>FOREIGN KEY (productos.id) ON DELETE CASCADE</td>
                    </tr>
                    <tr>
                        <td><strong>tipo_alerta</strong></td>
                        <td>VARCHAR(50)</td>
                        <td>Tipo de alerta</td>
                        <td>NOT NULL, CHECK (tipo_alerta IN ('bajo_stock', 'proximo_vencimiento', 'vencido'))</td>
                    </tr>
                    <tr>
                        <td><strong>descripcion</strong></td>
                        <td>TEXT</td>
                        <td>Descripción de la alerta</td>
                        <td>NOT NULL</td>
                    </tr>
                    <tr>
                        <td><strong>fecha_alerta</strong></td>
                        <td>TIMESTAMP</td>
                        <td>Fecha de creación de la alerta</td>
                        <td>DEFAULT CURRENT_TIMESTAMP</td>
                    </tr>
                    <tr>
                        <td><strong>estado_alerta</strong></td>
                        <td>VARCHAR(50)</td>
                        <td>Estado de la alerta</td>
                        <td>DEFAULT 'pendiente', CHECK (estado_alerta IN ('pendiente', 'resuelta', 'ignorada'))</td>
                    </tr>
                    <tr>
                        <td><strong>fecha_resolucion</strong></td>
                        <td>TIMESTAMP</td>
                        <td>Fecha de resolución</td>
                        <td>NULLABLE</td>
                    </tr>
                </tbody>
            </table>

            <h4><span class="emoji">�</span>Tabla: bajas</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>Campo</th>
                        <th>Tipo</th>
                        <th>Descripción</th>
                        <th>Restricciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>id</strong></td>
                        <td>SERIAL</td>
                        <td>Identificador único</td>
                        <td>PRIMARY KEY, AUTO_INCREMENT</td>
                    </tr>
                    <tr>
                        <td><strong>producto_id</strong></td>
                        <td>INTEGER</td>
                        <td>ID del producto relacionado</td>
                        <td>FOREIGN KEY (productos.id) ON DELETE CASCADE</td>
                    </tr>
                    <tr>
                        <td><strong>motivo_baja</strong></td>
                        <td>VARCHAR(255)</td>
                        <td>Motivo de la baja</td>
                        <td>NOT NULL</td>
                    </tr>
                    <tr>
                        <td><strong>fecha_baja</strong></td>
                        <td>TIMESTAMP</td>
                        <td>Fecha de la baja</td>
                        <td>DEFAULT CURRENT_TIMESTAMP</td>
                    </tr>
                    <tr>
                        <td><strong>usuario</strong></td>
                        <td>VARCHAR(255)</td>
                        <td>Usuario que realizó la baja</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>observaciones</strong></td>
                        <td>TEXT</td>
                        <td>Notas adicionales</td>
                        <td>NULLABLE</td>
                    </tr>
                </tbody>
            </table>

            <h4><span class="emoji">�</span>Tabla: sobrantes</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>Campo</th>
                        <th>Tipo</th>
                        <th>Descripción</th>
                        <th>Restricciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>id</strong></td>
                        <td>SERIAL</td>
                        <td>Identificador único</td>
                        <td>PRIMARY KEY, AUTO_INCREMENT</td>
                    </tr>
                    <tr>
                        <td><strong>producto_id</strong></td>
                        <td>INTEGER</td>
                        <td>ID del producto relacionado</td>
                        <td>FOREIGN KEY (productos.id) ON DELETE CASCADE</td>
                    </tr>
                    <tr>
                        <td><strong>cantidad</strong></td>
                        <td>INTEGER</td>
                        <td>Cantidad sobrante</td>
                        <td>NOT NULL, CHECK (cantidad > 0)</td>
                    </tr>
                    <tr>
                        <td><strong>fecha_envio</strong></td>
                        <td>TIMESTAMP</td>
                        <td>Fecha de envío</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>observaciones</strong></td>
                        <td>TEXT</td>
                        <td>Notas sobre el sobrante</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>observaciones_envio</strong></td>
                        <td>TEXT</td>
                        <td>Notas sobre el envío</td>
                        <td>NULLABLE</td>
                    </tr>
                    <tr>
                        <td><strong>created_at</strong></td>
                        <td>TIMESTAMP</td>
                        <td>Fecha de creación</td>
                        <td>DEFAULT CURRENT_TIMESTAMP</td>
                    </tr>
                    <tr>
                        <td><strong>updated_at</strong></td>
                        <td>TIMESTAMP</td>
                        <td>Fecha de actualización</td>
                        <td>DEFAULT CURRENT_TIMESTAMP</td>
                    </tr>
                </tbody>
            </table>

            <h3><span class="emoji">🔗</span>Relaciones entre Tablas</h3>
            <div class="highlight-box">
                <ul>
                    <li><strong>productos (1) ↔ (N) movimientos:</strong> Un producto puede tener múltiples movimientos</li>
                    <li><strong>productos (1) ↔ (N) alertas:</strong> Un producto puede generar múltiples alertas</li>
                    <li><strong>productos (1) ↔ (N) sobrantes:</strong> Un producto puede tener múltiples registros de sobrantes</li>
                    <li><strong>productos (1) ↔ (N) bajas:</strong> Un producto puede tener múltiples bajas parciales</li>
                </ul>
            </div>

            <h3><span class="emoji">📊</span>Índices y Performance</h3>
            <div class="code-block">
-- Índices principales para optimización<br>
CREATE INDEX idx_productos_codigo ON productos(codigo_item);<br>
CREATE INDEX idx_productos_estado ON productos(estado);<br>
CREATE INDEX idx_productos_vencimiento ON productos(fecha_vencimiento);<br>
CREATE INDEX idx_movimientos_producto ON movimientos(producto_id);<br>
CREATE INDEX idx_movimientos_fecha ON movimientos(fecha_movimiento);<br>
CREATE INDEX idx_alertas_estado ON alertas(estado_alerta);<br>
CREATE INDEX idx_alertas_tipo ON alertas(tipo_alerta);<br>
CREATE INDEX idx_sobrantes_estado ON sobrantes(estado);<br>
CREATE INDEX idx_bajas_fecha ON bajas(fecha_baja);
            </div>
        </div>

        <div id="funcionalidades">
            <h2><span class="emoji">⚙️</span>Funcionalidades Principales</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                <div class="highlight-box">
                    <h3><span class="emoji">📦</span>1. Gestión de Productos</h3>
                    <ul>
                        <li><strong>CRUD Completo:</strong> Crear, leer, actualizar, eliminar productos</li>
                        <li><strong>Búsqueda:</strong> Por nombre, código o marca</li>
                        <li><strong>Filtrado:</strong> Por estado (activo, vencido, baja, sobrante)</li>
                        <li><strong>Validación:</strong> Campos obligatorios y formatos correctos</li>
                        <li><strong>Stock:</strong> Control automático de stock actual</li>
                    </ul>
                </div>
                
                <div class="highlight-box">
                    <h3><span class="emoji">🔄</span>2. Control de Movimientos</h3>
                    <ul>
                        <li><strong>Entradas:</strong> Registro de ingreso de productos al almacén</li>
                        <li><strong>Salidas:</strong> Registro de entrega de productos</li>
                        <li><strong>Historial:</strong> Consulta completa de movimientos por producto</li>
                        <li><strong>Trazabilidad:</strong> Stock anterior y nuevo en cada movimiento</li>
                        <li><strong>Filtros:</strong> Por producto, tipo, rango de fechas</li>
                    </ul>
                </div>
                
                <div class="highlight-box">
                    <h3><span class="emoji">🚨</span>3. Sistema de Alertas</h3>
                    <ul>
                        <li><strong>Generación Automática:</strong> Alertas por stock bajo y productos próximos a vencer</li>
                        <li><strong>Estados:</strong> Pendiente, resuelto, ignorado</li>
                        <li><strong>Tipos:</strong> Bajo stock, próximo vencimiento, vencido</li>
                        <li><strong>Gestión:</strong> Resolver o ignorar alertas individualmente</li>
                        <li><strong>Estadísticas:</strong> Resumen de alertas por estado</li>
                    </ul>
                </div>
                
                <div class="highlight-box">
                    <h3><span class="emoji">📊</span>4. Reportes y Análisis</h3>
                    <ul>
                        <li><strong>Dashboard:</strong> Resumen general del sistema</li>
                        <li><strong>Inventario:</strong> Estado actual de todos los productos</li>
                        <li><strong>Movimientos:</strong> Reportes por fecha, tipo, producto</li>
                        <li><strong>Stock Bajo:</strong> Productos que requieren reposición</li>
                        <li><strong>Vencimientos:</strong> Productos próximos a vencer o vencidos</li>
                    </ul>
                </div>
                
                <div class="highlight-box">
                    <h3><span class="emoji">📦</span>5. Gestión de Sobrantes</h3>
                    <ul>
                        <li><strong>Registro:</strong> Marcar productos como sobrantes</li>
                        <li><strong>Seguimiento:</strong> Estado de envío a otras sedes</li>
                        <li><strong>Observaciones:</strong> Notas sobre el motivo del sobrante</li>
                        <li><strong>Historial:</strong> Consulta de todos los sobrantes registrados</li>
                    </ul>
                </div>
                
                <div class="highlight-box">
                    <h3><span class="emoji">📉</span>6. Gestión de Bajas</h3>
                    <ul>
                        <li><strong>Registro:</strong> Dar de baja productos por diferentes motivos</li>
                        <li><strong>Motivos:</strong> Vencido, dañado, perdido, otro</li>
                        <li><strong>Reducción Automática:</strong> El stock se reduce automáticamente</li>
                        <li><strong>Trazabilidad:</strong> Registro completo con usuario y observaciones</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="configuracion">
            <h2><span class="emoji">🚀</span>Configuración y Despliegue</h2>
            
            <h3>Variables de Entorno</h3>
            <div class="code-block">
# Base de datos Supabase<br>
SUPABASE_URL=https://tu-proyecto.supabase.co<br>
SUPABASE_ANON_KEY=tu-clave-anonima<br>
<br>
# Configuración del servidor<br>
PORT=3003<br>
NODE_ENV=development<br>
<br>
# CORS<br>
FRONTEND_URL=http://localhost:8080
            </div>

            <h3>Instalación Local</h3>
            <div class="code-block">
# 1. Clonar repositorio<br>
git clone https://github.com/tu-usuario/almacen-instituto.git<br>
cd almacen-instituto<br>
<br>
# 2. Instalar dependencias<br>
npm install<br>
<br>
# 3. Configurar variables de entorno<br>
cp .env.example .env<br>
# Editar .env con tus credenciales de Supabase<br>
<br>
# 4. Iniciar servidor de desarrollo<br>
npm run dev<br>
<br>
# 5. Verificar funcionamiento<br>
curl http://localhost:3003/api/health
            </div>
        </div>

        <div id="testing">
            <h2><span class="emoji">🧪</span>Testing y Validación</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                <div class="highlight-box">
                    <h3><span class="emoji">🛠️</span>Herramientas de Testing</h3>
                    <ul>
                        <li><strong>Jest:</strong> Framework de testing</li>
                        <li><strong>Supertest:</strong> Testing de API REST</li>
                        <li><strong>Postman:</strong> Testing manual de endpoints</li>
                        <li><strong>Thunder Client:</strong> Testing integrado en VS Code</li>
                    </ul>
                </div>
                
                <div class="highlight-box">
                    <h3><span class="emoji">✅</span>Cobertura de Testing</h3>
                    <ul>
                        <li><strong>31 endpoints</strong> probados y funcionales</li>
                        <li><strong>Validación de datos</strong> completa</li>
                        <li><strong>Manejo de errores</strong> verificado</li>
                        <li><strong>Respuestas estandarizadas</strong> confirmadas</li>
                    </ul>
                </div>
            </div>

            <h3>Archivos de Testing Disponibles</h3>
            <ul>
                <li><code>postman-collection-completa.json</code> - Colección Postman con 31 endpoints</li>
                <li><code>ENDPOINTS-MANUAL-TESTING.md</code> - Lista de URLs para testing manual</li>
                <li><code>thunder-client-15-endpoints.json</code> - Colección Thunder Client Parte 1</li>
                <li><code>thunder-client-12-parte-2.json</code> - Colección Thunder Client Parte 2</li>
            </ul>
        </div>

        <div id="integracion">
            <h2><span class="emoji">🔗</span>Integración con Frontend</h2>
            
            <h3>Configuración CORS</h3>
            <p>El backend está configurado para aceptar peticiones desde:</p>
            <ul>
                <li><code>http://localhost:8080</code> (NetBeans típico)</li>
                <li><code>http://localhost:3000</code> (React/Vue desarrollo)</li>
                <li>Configurable vía variable de entorno <code>FRONTEND_URL</code></li>
            </ul>

            <h3>Ejemplo de Integración Java (NetBeans)</h3>
            <div class="code-block">
import java.net.http.HttpClient;<br>
import java.net.http.HttpRequest;<br>
import java.net.http.HttpResponse;<br>
import java.net.URI;<br>
<br>
public class AlmacenAPIClient {<br>
&nbsp;&nbsp;&nbsp;&nbsp;private static final String BASE_URL = "http://localhost:3003/api";<br>
&nbsp;&nbsp;&nbsp;&nbsp;private final HttpClient httpClient;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Obtener todos los productos<br>
&nbsp;&nbsp;&nbsp;&nbsp;public String getAllProducts() throws Exception {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpRequest request = HttpRequest.newBuilder()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.uri(URI.create(BASE_URL + "/products"))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.header("Content-Type", "application/json")<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.GET()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.build();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpResponse&lt;String&gt; response = httpClient.send(request,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpResponse.BodyHandlers.ofString());<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return response.body();<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}
            </div>
        </div>

        <div style="margin: 40px 0;">
            <h2><span class="emoji">📈</span>Estado Actual del Proyecto</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div class="highlight-box" style="border-color: #27ae60; background: #e8f5e8;">
                    <h3><span class="emoji">✅</span>COMPLETADO (100%)</h3>
                    <ul>
                        <li><strong>Backend API REST</strong> completo con 31 endpoints</li>
                        <li><strong>Base de datos</strong> PostgreSQL configurada en Supabase</li>
                        <li><strong>Validación de datos</strong> con esquemas Joi</li>
                        <li><strong>Sistema de alertas</strong> automático</li>
                        <li><strong>Documentación técnica</strong> completa</li>
                        <li><strong>Testing</strong> manual y automatizado</li>
                        <li><strong>Configuración CORS</strong> para integración</li>
                    </ul>
                </div>
                
                <div class="highlight-box" style="border-color: #f39c12; background: #fef9e7;">
                    <h3><span class="emoji">🔄</span>EN PROGRESO</h3>
                    <ul>
                        <li><strong>Frontend NetBeans</strong> (integración)</li>
                        <li><strong>Tests automatizados</strong> adicionales</li>
                        <li><strong>Optimizaciones</strong> de rendimiento</li>
                    </ul>
                </div>
                
                <div class="highlight-box" style="border-color: #9b59b6; background: #f4ecf7;">
                    <h3><span class="emoji">📋</span>PRÓXIMAS FASES</h3>
                    <ul>
                        <li><strong>Autenticación y autorización</strong> de usuarios</li>
                        <li><strong>Logs y auditoría</strong> de operaciones</li>
                        <li><strong>Notificaciones por email</strong> para alertas</li>
                        <li><strong>Dashboard web</strong> administrativo</li>
                        <li><strong>Integración con SIGA</strong> (sistema académico)</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="conclusion">
            <h2><span class="emoji">🎉</span>Conclusión</h2>
            <p style="font-size: 1.2em; margin-bottom: 20px;">
                Este sistema de control de almacén representa una solución completa y moderna para la gestión de inventario del Instituto Lurín.
            </p>
            <p style="font-size: 1.1em;">
                Con una arquitectura sólida, documentación detallada y testing exhaustivo, está listo para ser integrado con el sistema NetBeans existente.
            </p>
            <div style="margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                <h3 style="margin: 0; color: #ecf0f1;">🚀 El proyecto está 100% funcional y listo para producción</h3>
            </div>
        </div>

        <div style="text-align: center; margin-top: 40px; padding: 20px; border-top: 1px solid #dee2e6;">
            <p><em>Documentación creada por: Cristhian Medina</em></p>
            <p><em>Fecha: 25 de Julio, 2025 • Versión: 1.0</em></p>
        </div>
    </div>
</body>
</html>
